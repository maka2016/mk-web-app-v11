# 信封功能

## 用户故事

## 简帖用户

想要邀请宾客参考他的宴会的用户，在简帖上创建邀请函

### 嘉宾

访问简帖用户为他创建的邀请函，邀请函加载时展示信封，增强邀请的仪式感

### 设计师

设计简帖模版时上传信封图（4张：作品背景、外侧材质、内侧材质、印章）、动态的视频背景（用作整个作品的背景）

## 功能描述

### 信封展示

1. 在作品或模版的加载时，作为loading页展示信封动画，信封动画时左开口打开
2. 信封由4张可配置图片组成
   1. 作品背景图：作为整个加载页面的背景
   2. 外侧材质贴纸图：用于左右开口的外侧，材质平铺重复
   3. 内侧材质贴纸图：用于左右开口的内侧和信封内页背景，材质平铺重复
   4. 信封印章：引导用户点击开启
3. 信封形状由固定的蒙版图片定义
   - 左开口蒙版：`/assets/envelope/left-open.png`
   - 右开口蒙版：`/assets/envelope/right-open.png`
   - 信封内页蒙版：`/assets/envelope/inner.png`

### 信封动画

1. 用户进来时显示完整的竖版 C6 信封（114×162mm），信封左开口覆盖右开口，并且宽度占视口的 80%、垂直居中
   1. 信封的开口规则是内页在最底部，左开口对齐内页的左上角
   2. 邀请函作为信的内容在内页与开口层之间，距离信封有24px的内边距
   3. 中间显示信封印章，用户点击后再开始信封打开动画
2. 信封打开动画：左开口缓慢打开，在中途右开口也打开，露出信封的邀请函网页内容（DOM #auto-scroll-container），信封内容从小到大铺满屏幕，随后完成整个动画

### 信封编辑

1. 只有设计师可以编辑信封，上传4张图
   1. 作品背景图：建议较大尺寸，用于平铺整个页面
   2. 外侧材质贴纸图：建议较大尺寸，用于平铺左右开口外侧
   3. 内侧材质贴纸图：建议较大尺寸，用于平铺左右开口内侧和信封内页
   4. 印章图：用于引导用户点击

**说明**：

- 材质贴纸图会通过固定的形状蒙版图裁切，只在信封形状区域内显示
- 蒙版图由系统提供，不需要设计师上传
- 蒙版图的透明区域不会显示材质，不透明区域会显示材质

### 信封阴影

支持为左右开口分别配置阴影效果，阴影会遵循 mask 蒙版的形状：

```typescript
// 左侧开口阴影配置
leftFlapShadow: {
  offsetX: 0,      // 水平偏移（px，默认 0）
  offsetY: 4,      // 垂直偏移（px，默认 4）
  blur: 8,         // 模糊半径（px，默认 8）
  color: 'rgba(0, 0, 0, 0.15)'  // 阴影颜色（默认半透明黑色）
}

// 右侧开口阴影配置
rightFlapShadow: {
  offsetX: 0,
  offsetY: 4,
  blur: 8,
  color: 'rgba(0, 0, 0, 0.15)'
}
```

**技术说明**：

- 使用 CSS `filter: drop-shadow()` 实现，可以完美遵循 mask 蒙版的形状
- 左右开口的正面和背面都会应用相同的阴影配置
- 如果不配置阴影，则不会显示阴影效果

### 视频背景

1. 设计师上传视频背景，作为整个作品的背景，上传视频使用uploadFile2 api，因为旧api不支持视频上传
