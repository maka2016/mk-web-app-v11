# 模板商城展示功能需求文档

## 文档导航

本功能包含以下 3 个核心文档：

1. **requirements.md**（本文档）- 功能需求和验收标准
2. **design.md** - 技术设计和实现方案
3. **tasks.md** - 开发任务清单

## 概述

为简帖模板商城系统添加展示功能，允许设计师为模板配置展示信息，包括多张预览图、封面图、展示标题和富文本描述。简帖用户可以通过类似小红书的上图下文方式浏览模板详情，提升模板在商城中的展示效果和用户体验。

### 核心功能

- **多图展示**: 设计师可为模板添加最多 9 张预览图，并选择一张作为封面图
- **富文本描述**: 提供展示标题和富文本描述编辑，支持格式化内容
- **沉浸式详情页**: 采用小红书式的上图下文布局，简帖用户可优质浏览模板
- **响应式设计**: 移动端优先，适配所有设备尺寸
- **使用模板**: 简帖用户可直接点击"使用此模板"开始创作

### 技术栈

- **前端框架**: React 19 + Next.js 15
- **状态管理**: MobX (WorksStore)
- **样式方案**: @workspace/ui + Tailwind CSS（禁用 SCSS）
- **数据持久化**: 基于 WorksStore，存储在 `IWorksData.templateShowcaseInfo`
- **富文本编辑**: Tiptap 或 Lexical
- **图片轮播**: embla-carousel-react
- **图标库**: lucide-react
- **工具函数**: 使用 `@mk/utils` 中的 `random()` 生成唯一 ID

## 业务背景

简帖是一个模板商城平台，业务流程如下：

1. **设计师**创作并上架**模板**到简帖商城
2. **简帖用户**在商城浏览并选择**模板**
3. **简帖用户**基于选择的**模板**进行创作，生成自己的**作品**

本需求关注的是第 1 步和第 2 步：设计师如何为模板配置展示信息，以及用户如何浏览模板详情。

## 术语表

- **Template**: 模板，设计师创作并上架到简帖商城的商品
- **Work**: 作品，简帖用户基于模板创作的内容
- **Designer**: 设计师，模板的创作者和上架者
- **User**: 简帖用户，在商城浏览模板并基于模板创作作品的用户
- **Preview_Image**: 预览图，模板的展示图片，可以有多张
- **Cover_Image**: 封面图，从预览图中选择的作为主要展示的图片
- **Display_Title**: 展示标题，模板在商城中显示的标题
- **Display_Description**: 展示描述，模板的详细说明，支持富文本格式
- **Template_Detail_Page**: 模板详情页，类似小红书的上图下文展示页面
- **Marketplace**: 模板商城，展示和浏览模板的平台
- **Rich_Text**: 富文本，支持格式化的文本内容（粗体、斜体、列表等）

## 需求

### 需求 1

**用户故事:** 作为设计师，我希望能为模板添加多张预览图，以便在商城中全方位展示我的模板

#### 验收标准

1. WHEN 设计师在模板编辑页面点击"商城展示设置"按钮，THE 系统 SHALL 显示商城展示配置面板
2. WHEN 设计师在配置面板中点击"添加预览图"按钮，THE 系统 SHALL 打开图片选择器或上传界面
3. WHEN 设计师上传或选择图片，THE 系统 SHALL 验证图片格式（支持 jpg、png、webp）和大小（不超过 5MB）
4. WHEN 图片上传成功，THE 系统 SHALL 将图片添加到预览图列表中
5. WHEN 设计师添加多张预览图，THE 系统 SHALL 支持最多添加 9 张预览图
6. WHEN 设计师查看预览图列表，THE 系统 SHALL 显示所有预览图的缩略图
7. WHEN 设计师在预览图上进行拖拽，THE 系统 SHALL 支持调整预览图的显示顺序

### 需求 2

**用户故事:** 作为设计师，我希望能选择一张预览图作为封面图，以便在商城列表中突出展示

#### 验收标准

1. WHEN 设计师查看预览图列表，THE 系统 SHALL 在每张预览图上显示"设为封面"按钮
2. WHEN 设计师点击"设为封面"按钮，THE 系统 SHALL 将该图片标记为封面图
3. WHEN 封面图被设置，THE 系统 SHALL 在该图片上显示"封面"标识
4. WHEN 设计师设置新的封面图，THE 系统 SHALL 自动取消之前的封面图标记
5. WHEN 预览图列表为空时，THE 系统 SHALL 提示设计师先添加预览图
6. WHEN 封面图被删除，THE 系统 SHALL 自动将第一张预览图设为封面（如果存在其他预览图）
7. WHEN 简帖用户在商城列表浏览模板，THE 系统 SHALL 显示模板的封面图

### 需求 3

**用户故事:** 作为设计师，我希望能管理模板的预览图，以便维护模板展示的准确性

#### 验收标准

1. WHEN 设计师在预览图上悬停，THE 系统 SHALL 显示操作按钮（删除、设为封面）
2. WHEN 设计师点击删除按钮，THE 系统 SHALL 显示确认对话框
3. WHEN 设计师确认删除，THE 系统 SHALL 从预览图列表中移除该图片
4. WHEN 预览图被删除，THE 系统 SHALL 如果该图片是封面图则重新指定封面图
5. WHEN 设计师点击预览图，THE 系统 SHALL 显示大图预览
6. WHEN 设计师替换预览图，THE 系统 SHALL 允许选择新图片替换现有图片

### 需求 4

**用户故事:** 作为设计师，我希望能为模板设置展示标题和描述，以便更好地介绍我的模板

#### 验收标准

1. WHEN 设计师在商城展示配置面板中查看表单，THE 系统 SHALL 显示"展示标题"输入框
2. WHEN 设计师输入展示标题，THE 系统 SHALL 验证标题长度（1-100字符）
3. WHEN 标题为空或超长，THE 系统 SHALL 显示相应的错误提示
4. WHEN 设计师在配置面板中查看描述区域，THE 系统 SHALL 显示富文本编辑器
5. WHEN 设计师编辑描述内容，THE 系统 SHALL 支持基础富文本格式（粗体、斜体、下划线、列表、链接）
6. WHEN 设计师输入描述，THE 系统 SHALL 验证描述长度（不超过 5000 字符）
7. WHEN 描述超长，THE 系统 SHALL 显示字数统计和警告提示

### 需求 5

**用户故事:** 作为设计师，我希望能预览模板在商城中的展示效果，以便确认配置是否满意

#### 验收标准

1. WHEN 设计师在配置面板中点击"预览效果"按钮，THE 系统 SHALL 显示预览模式
2. WHEN 预览模式打开，THE 系统 SHALL 模拟商城列表卡片展示（显示封面图、标题）
3. WHEN 设计师点击预览卡片，THE 系统 SHALL 显示模板详情页预览
4. WHEN 详情页预览显示，THE 系统 SHALL 使用类似小红书的上图下文布局
5. WHEN 设计师滑动详情页，THE 系统 SHALL 正确展示所有预览图和描述内容
6. WHEN 设计师关闭预览，THE 系统 SHALL 返回配置面板

### 需求 6

**用户故事:** 作为简帖用户，我希望能在商城中浏览模板详情，以便了解模板的完整信息并决定是否使用

#### 验收标准

1. WHEN 简帖用户在商城列表中点击模板卡片，THE 系统 SHALL 打开模板详情页
2. WHEN 详情页加载，THE 系统 SHALL 采用上图下文布局（类似小红书）
3. WHEN 详情页上部显示，THE 系统 SHALL 展示可滑动的预览图轮播
4. WHEN 简帖用户滑动预览图，THE 系统 SHALL 平滑切换图片并显示指示器
5. WHEN 简帖用户点击预览图，THE 系统 SHALL 进入全屏查看模式
6. WHEN 详情页下部显示，THE 系统 SHALL 展示模板标题和富文本描述
7. WHEN 描述内容较长，THE 系统 SHALL 支持"展开/收起"功能
8. WHEN 简帖用户滚动详情页，THE 系统 SHALL 提供流畅的滚动体验
9. WHEN 详情页显示，THE 系统 SHALL 展示模板的其他信息（设计师、创建时间、使用次数等）
10. WHEN 详情页显示，THE 系统 SHALL 提供"使用此模板"操作按钮

### 需求 7

**用户故事:** 作为开发者，我希望模板展示数据能正确持久化，以便保证数据的一致性和完整性

#### 验收标准

1. WHEN 设计师保存商城展示配置，THE 系统 SHALL 将数据保存到模板数据结构中
2. WHEN 系统保存预览图，THE 系统 SHALL 存储图片 URL、顺序和封面标记
3. WHEN 系统保存标题和描述，THE 系统 SHALL 正确处理特殊字符和富文本格式
4. WHEN 系统加载模板数据，THE 系统 SHALL 正确恢复所有商城展示配置
5. WHEN 模板被复制或克隆，THE 系统 SHALL 正确处理展示数据的复制
6. WHEN 数据结构发生变化，THE 系统 SHALL 保持向后兼容性

### 需求 8

**用户故事:** 作为产品经理，我希望商城展示功能支持响应式设计，以便在不同设备上都有良好体验

#### 验收标准

1. WHEN 简帖用户在移动端访问商城，THE 系统 SHALL 自动适配移动端布局
2. WHEN 简帖用户在移动端查看详情页，THE 系统 SHALL 优化图片轮播的触摸交互
3. WHEN 简帖用户在平板或桌面端访问，THE 系统 SHALL 利用更大的屏幕空间优化布局
4. WHEN 页面在不同设备间切换，THE 系统 SHALL 保持数据和状态的一致性
5. WHEN 图片加载，THE 系统 SHALL 根据设备屏幕尺寸加载适当分辨率的图片
